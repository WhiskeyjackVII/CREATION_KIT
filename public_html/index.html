<!DOCTYPE html>
<html>
	<head>
		<title>Game</title>
                <script src="js/Framework/ActorHandler.js" type="text/javascript"></script>
                <script src="js/Framework/Actor.js" type="text/javascript"></script>
                <script src="js/libs/keypress/keypress.js" type="text/javascript"></script>
                <script src="js/Framework/Commands.js" type="text/javascript"></script>
                <script src="js/Framework/GUID_GENERATOR.js" type="text/javascript"></script>
                <script src="js/Framework/ActorFactory.js" type="text/javascript"></script>
	</head>
	<body>
	
		<canvas id="gameCanvas" width=800 height=600 style= "border:1px solid black">
			Browser doesn't support HTML5
		</canvas>
		
		<h1>Test</h1>
		<input type="button" onclick="runGameLoop()" value="Run Game">
                <input type="button" onclick="setup()" value="Setup">
                
		<script type='text/javascript'>
      		
                var CANVAS_WIDTH = 480;
                var CANVAS_HEIGHT = 320;
                var FPS = 30;
        	var gameLoop;
                var ACTION_HANDLER;
                var game_canvas;
                var game_context;
        	var ACTOR_FACTORY;
                
                
                    
                function setup(){
                    
                    game_canvas = document.getElementById("gameCanvas");
                    game_context = game_canvas.getContext("2d");
                    ACTOR_HANDLER = new ActorHandler();
                    ACTOR_FACTORY = new ActorFactory();
                    
                    CANVAS_WIDTH = game_canvas.width;
                    CANVAS_HEIGHT = game_canvas.height;
                
                    var flowers = ["","flower_red","flower_blue","flower_green","flower_purple"];
                    var spiders = ["","spider_black","spider_red","spider_blue","spider_green"];
                
                    for(var i = 1; i <= flowers.length; i++){
                        ACTOR_HANDLER.registerCollisionCheck("PLAYER",flowers[i], new KillCommand(new ScoreCommand(new AdapterCommand(new CreateActorCommand(new CreateActorCommand(null))))));
                    }
                    ACTOR_HANDLER.registerCollisionCheck("PLAYER",spiders[i], new KillCommand(new ScoreCommand(null)));
                
                    
                
                    for(var i = 1; i <= spiders.length; i++){
                        ACTOR_FACTORY.registerActor(spiders[i],0,3*i,true,"images/FotBB/" + spiders[i] + ".png");
                    }
                
                    for(var i = 1; i <= flowers.length; i++){
                        ACTOR_FACTORY.registerActor(flowers[i],(250*i),0,true,"images/FotBB/" + flowers[i] + ".png");
                    }
                
                    ACTOR_FACTORY.registerActor("PLAYER",0,7,false,"images/FotBB/bee.png");
                
                    
                    for(var i = 0; i < 2; i++){
                        ACTOR_HANDLER.registerActor(ACTOR_FACTORY.createActorRandom("spider_black"));
                        ACTOR_HANDLER.registerActor(ACTOR_FACTORY.createActorRandom("flower_red"));
                    }
                    
                    ACTOR_HANDLER.registerPlayer(ACTOR_FACTORY.createActor("PLAYER",300,300),1);
                    
                }
        	
        	function runGameLoop(){
        		gameLoop = setInterval(function() {
                            
                            draw();
                            update();
        		}, 1000/FPS);
        	}
        	function draw() {
                   // console.log("DRAWING STARTING");
                    game_context.clearRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);
        		ACTOR_HANDLER.drawActors();
                    //console.log("DRAWING FINISHED");
        	}
        	function update(){
                    //console.log("UPADTING STARTING");
        		ACTOR_HANDLER.update();
                    //console.log("UPADTING FINISHED");
        	}
        	
        	
        	
        </script>
	</body>
</html>